{
  "Name": "CALPADS Student information",
  "Description": "Level 2 validation for CALPADS student information",
  "EnvironmentType": "Ed-Fi v3.X with CALPADS descriptors",
  "Containers": [
    {
      "Name": "formatting",
      "Description": "Formatting validations",
      "Rules": [
        {
          "Name": "Student ID length",
          "Description": "Student ID should not be more than 15 characters.",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  SchoolId as EducationOrganizationId,\n  'School' as Discriminator\nFROM\n  edfi.Student\n  JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE\n  LEN(StudentUniqueId) > 15;",
          "Version": "1",
          "ExternalRuleId": "FRMT0001-2.10",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Student first name length",
          "Description": "Student first name should not be more than 15 characters.",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT StudentUniqueId,\n\t\tSchoolId as EducationOrganizationId,\n\t\t Student.FirstName,\n\t\t Student.MiddleName,\n\t\t Student.LastSurname,\n\t\t'School' as Discriminator\nFROM edfi.Student\nJOIN edfi.StudentSchoolAssociation\n\ton student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE LEN(Student.FirstName) > 30;\n",
          "Version": "1",
          "ExternalRuleId": "FRMT0001-2.11",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Student middle name length",
          "Description": "Student first name should not be more than 15 characters.",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  StudentUniqueId,\n  SchoolId as EducationOrganizationId,\n  Student.FirstName,\n  Student.MiddleName,\n  Student.LastSurname,\n  'School' as Discriminator\nFROM\n  edfi.Student\n  JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE\n  LEN(Student.MiddleName) > 30;",
          "Version": "1",
          "ExternalRuleId": "FRMT0001-2.12",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Student last name",
          "Description": "Student last name should not be more than 15 characters.",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  StudentUniqueId,\n  SchoolId as EducationOrganizationId,\n  Student.FirstName,\n  Student.MiddleName,\n  Student.LastSurname,\n  'School' as Discriminator\nFROM\n  edfi.Student\n  JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE\n  LEN(Student.LastSurname) > 30;",
          "Version": "1",
          "ExternalRuleId": "FRMT0001-2.13",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Student  name suffix length",
          "Description": "Student name suffix should not be more than 3 characters.",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT StudentUniqueId,\n\t\tSchoolId as EducationOrganizationId,\n\t\t Student.FirstName,\n\t\t Student.MiddleName,\n\t\t Student.LastSurname,\n\t\t Student.GenerationCodeSuffix,\n\t\t'School' as Discriminator\nFROM edfi.Student\nJOIN edfi.StudentSchoolAssociation\n\ton student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE LEN(Student.GenerationCodeSuffix) > 3;",
          "Version": "1",
          "ExternalRuleId": "FRMT0001-2.14",
          "MaxNumberResults": null,
          "Tags": []
        }
      ],
      "Tags": []
    },
    {
      "Name": "General",
      "Description": "\"GER\" rules",
      "Rules": [
        {
          "Name": "School Year missing from enrollment",
          "Description": "School Year is mandatory",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT StudentUniqueId,\n\t\tSchoolId as EducationOrganizationId,\n\t\t SchoolYear,\n\t\t'School' as Discriminator\nFROM edfi.Student\nJOIN edfi.StudentSchoolAssociation\n\ton student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE StudentSchoolAssociation.SchoolYear IS NULL;",
          "Version": "1",
          "ExternalRuleId": "GERR0001-2.08",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "student missing gender",
          "Description": "Student is missing gender",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  StudentUniqueId,\n  SchoolId as EducationOrganizationId,\n  SchoolYear,\n  'School' as Discriminator\nFROM\n  edfi.Student\n  JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE\n  student.BirthSexDescriptorId IS NULL;",
          "Version": "1",
          "ExternalRuleId": "GERR0001-2.19",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "student missing birth country ",
          "Description": "Student is birth country",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  StudentUniqueId,\n  SchoolId as EducationOrganizationId,\n  SchoolYear,\n  'School' as Discriminator\nFROM\n  edfi.Student\n  JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE\n  student.BirthCountryDescriptorId IS NULL;",
          "Version": "1",
          "ExternalRuleId": "GERR0001-2.22",
          "MaxNumberResults": null,
          "Tags": []
        }
      ],
      "Tags": []
    },
    {
      "Name": "IVR rules",
      "Description": "IVR rules",
      "Rules": [
        {
          "Name": "Student age out of bounds",
          "Description": "Student age is over 22 for non-adult education, or adult education and less than 16 or more than 80",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT * FROM\n(\nSELECT StudentUniqueId,\n\t\tSchoolId as EducationOrganizationId,\n\t\tbirthdate,\n\t\tdatediff(year,   birthdate, getdate()) age,\n\t\t'School' as Discriminator,\n\t\tCodeValue as Grade\nFROM edfi.Student\nJOIN edfi.StudentSchoolAssociation\n\ton student.StudentUSI = StudentSchoolAssociation.StudentUSI\nJOIN edfi.descriptor \n\ton Descriptor.DescriptorId = StudentSchoolAssociation.EntryGradeLevelDescriptorId\n) as tab1\nWHERE (age > 22)\n\t\tOR\n\t\t(Age < 16 AND Grade in ('Adult Education', 'AD'))\n\t\tOR\n\t\t(Age > 80 AND Grade in ('Adult Education', 'AD'))\n",
          "Version": "1",
          "ExternalRuleId": "IVR0012",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Enrollment Start Date Less Than Birth Date",
          "Description": "Enrollment Start Date Less Than Birth Date\n",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  StudentUniqueId,\n  SchoolId as EducationOrganizationId,\n  birthdate,\n  StudentSchoolAssociation.entryDate,\n  'School' as Discriminator\nFROM\n  edfi.Student\n  JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\nWHERE\n  birthdate > EntryDate",
          "Version": "1",
          "ExternalRuleId": "IVR0013 / SINF0013",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Invalid age for Kindergarten (KN) student",
          "Description": "Invalid age for Kindergarten (KN) student",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  *\nFROM\n  (\n    SELECT\n      StudentUniqueId,\n      SchoolId as EducationOrganizationId,\n      birthdate,\n      datediff(year, birthdate, getdate()) age,\n      'School' as Discriminator,\n      GradeDescriptor.CodeValue as Grade\n    FROM\n      edfi.Student\n      JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\n      JOIN edfi.descriptor GradeDescriptor on GradeDescriptor.DescriptorId = StudentSchoolAssociation.EntryGradeLevelDescriptorId\n      LEFT JOIN edfi.StudentSpecialEducationProgramAssociation ON StudentSpecialEducationProgramAssociation.StudentUSI = Student.StudentUSI\n    WHERE\n      StudentSpecialEducationProgramAssociation.StudentUSI is null\n  ) as tab1\nWHERE\n  (\n    age < 4\n    or age > 7\n  )\n  AND Grade in ('Kindergarten', 'KN')",
          "Version": "1",
          "ExternalRuleId": "IVR0262 / SINF0262",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Invalid Student Age for Student Initial US School Enrollment Date K-12",
          "Description": "If Student Initial US School Enrollment Date K-12 is populated, then student age as of that date must be at least 4 years.",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n  *\nFROM\n  (\n    SELECT\n      StudentUniqueId,\n      SchoolId as EducationOrganizationId,\n      birthdate,\n      datediff(\n        year,\n        birthdate,\n        StudentMigrantEducationProgramAssociation.USInitialSchoolEntry\n      ) ageAtEntry,\n      'School' as Discriminator,\n      GradeDescriptor.CodeValue as Grade,\n      StudentMigrantEducationProgramAssociation.USInitialSchoolEntry\n    FROM\n      edfi.Student\n      JOIN edfi.StudentSchoolAssociation on student.StudentUSI = StudentSchoolAssociation.StudentUSI\n      JOIN edfi.descriptor GradeDescriptor on GradeDescriptor.DescriptorId = StudentSchoolAssociation.EntryGradeLevelDescriptorId\n      JOIN edfi.StudentMigrantEducationProgramAssociation ON StudentMigrantEducationProgramAssociation.StudentUSI = Student.StudentUSI\n  ) as tab1\nWHERE\n  ageAtEntry < 4;",
          "Version": "1",
          "ExternalRuleId": "IVR0059 SINF0059",
          "MaxNumberResults": null,
          "Tags": []
        },
        {
          "Name": "Missing Student Initial US School Enrollment Date",
          "Description": "If 1) Student Grade Level Code = KN, 01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12, UE, US AND 2) a) Student Birth Country Code not equal to US or PR or b) English Language Acquisition Status = EL Then Student Initial US School Enrollment Date must be populated",
          "ErrorMessage": null,
          "SeverityLevel": 1,
          "Resolution": null,
          "Sql": "SELECT\n    StudentUniqueId,\n    SchoolId as EducationOrganizationId,\n    'School' as Discriminator,\n    GradeDescriptor.CodeValue as Grade,\n\tStudentMigrantEducationProgramAssociation.USInitialSchoolEntry,\n\tCountryDescriptor.CodeValue as BirthCountry\nFROM    edfi.Student\nJOIN edfi.StudentSchoolAssociation \n\ton student.StudentUSI = StudentSchoolAssociation.StudentUSI\nJOIN edfi.descriptor GradeDescriptor\n\ton GradeDescriptor.DescriptorId = StudentSchoolAssociation.EntryGradeLevelDescriptorId\nJOIN edfi.descriptor CountryDescriptor\n\ton CountryDescriptor.DescriptorId = Student.BirthCountryDescriptorId\nLEFT JOIN edfi.StudentMigrantEducationProgramAssociation\n\tON StudentMigrantEducationProgramAssociation.StudentUSI = Student.StudentUSI\nWHERE GradeDescriptor.CodeValue IN ('KN', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', 'UE', 'US')\nAND StudentMigrantEducationProgramAssociation.USInitialSchoolEntry IS NULL;",
          "Version": "1",
          "ExternalRuleId": "IVR0058",
          "MaxNumberResults": null,
          "Tags": []
        }
      ],
      "Tags": []
    }
  ],
  "Tags": [],
  "DestinationTable": "EdFiRuleExecutionLogDetails2",
  "DestinationStructure": "[{\"Name\":\"id\",\"Type\":\"int\",\"IsNullable\":false},{\"Name\":\"educationorganizationid\",\"Type\":\"int\",\"IsNullable\":true},{\"Name\":\"studentuniqueid\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"finecode\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"coursecode\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"discriminator\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"programname\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"staffuniqueid\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"otherdetails\",\"Type\":\"nvarchar\",\"IsNullable\":true},{\"Name\":\"ruleexecutionlogid\",\"Type\":\"int\",\"IsNullable\":false}]"
}